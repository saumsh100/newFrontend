{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{2844:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0});var n=function(e,t,a){return t&&r(e.prototype,t),a&&r(e,a),e};function r(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var i=D(a(0)),l=a(1),u=D(l),s=a(16),o=a(15),d=D(a(2498)),c=D(a(2499)),h=a(72),f=a(8),y=D(a(101)),p=D(a(266)),m=a(371),S=D(a(366)),v=D(a(948)),b=D(a(534)),k=D(a(2845));function D(e){return e&&e.__esModule?e:{default:e}}var g=[\"monday\",\"tuesday\",\"wednesday\",\"thursday\",\"friday\",\"saturday\",\"sunday\"],w=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(O,l.Component),n(O,[{key:\"reinitializeState\",value:function(){this.setState({active:!1})}},{key:\"delete\",value:function(e){if(!confirm(\"Delete Schedule?\"))return null;var t=Object.assign({},this.props.weeklySchedule.toJS());t.weeklySchedules.splice(e,1),t.weeklySchedules[0]||(t.isAdvanced=!1);var a=this.props.weeklySchedule.merge(t);return this.props.updateEntityRequest({key:\"weeklySchedule\",model:a,alert:{success:{body:\"Clinic Pattern Deleted\"},error:{body:\"Clinic Pattern Deleted Failed\"}}})}},{key:\"sendEdit\",value:function(a,n){var r=Object.assign({},this.props.weeklySchedule.toJS());r.weeklySchedules=r.weeklySchedules||[],Object.keys(n).forEach(function(e){if(n[e].breaks)r.weeklySchedules[a][e].breaks=n[e].breaks;else{var t=r.weeklySchedules[a][e].breaks;r.weeklySchedules[a][e]=n[e],r.weeklySchedules[a][e].breaks=t}});var e=this.props.weeklySchedule.merge(r);this.props.updateEntityRequest({key:\"weeklySchedule\",model:e,alert:{success:{body:\"Clinic Office Hours Updated\"},error:{body:\"Clinic Office Hours Update Failed\"}}})}},{key:\"changeStartDate\",value:function(e){var t=this,a=Object.assign({},this.props.weeklySchedule.toJS());a.startDate=e.startDate;var n=this.props.weeklySchedule.merge(a);return this.props.updateEntityRequest({key:\"weeklySchedule\",model:n,alert:{success:{body:\"Clinic Office Hours Updated\"},error:{body:\"Clinic Office Hours Update Failed\"}}}).then(function(){t.setState({active:!1})})}},{key:\"createPattern\",value:function(){var e=this,t=confirm(\"Are you sure you want to create a pattern?\");if(!t)return null;var a=Object.assign({},this.props.weeklySchedule.toJS()),n=Object.assign({},this.props.weeklySchedule.toJS());if(a.weeklySchedules=a.weeklySchedules||[],!n.startDate)return window.alert(\"Please put in a start date before creating a pattern!\"),null;delete n.weeklySchedules,delete n.startDate,delete n.id,a.weeklySchedules.push(n),a.isAdvanced=!0;var r=this.props.weeklySchedule.merge(a);return this.props.updateEntityRequest({key:\"weeklySchedule\",model:r,alert:{success:{body:\"Clinic Office Hours Updated\"},error:{body:\"Clinic Office Hours Update Failed\"}}}).then(function(){e.setState({active:!1})})}},{key:\"openModal\",value:function(){this.setState({active:!0})}},{key:\"render\",value:function(){function e(e,a){var n=Object.assign({},i.toJS());g.forEach(function(t){Object.keys(a[t]).forEach(function(e){n[t][e]=a[t][e]})}),r.props.updateEntityRequest({key:\"weeklySchedule\",model:i.merge(n),alert:{success:{body:\"Clinic Office Hours Updated\"},error:{body:\"Clinic Office Hours Update Failed\"}}})}var r=this,t=this.props,i=t.weeklySchedule,a=(t.activeAccount,null);i&&i.toJS().weeklySchedules&&(a=i.toJS().weeklySchedules.map(function(e,t){return u.default.createElement(\"div\",null,u.default.createElement(\"div\",{className:b.default.orSpacer}),u.default.createElement(\"div\",{className:b.default.flexHeader,\"data-test-id\":\"pattern_\"+t},u.default.createElement(f.Header,{contentHeader:!0,title:\"Week \"+(t+2)+\" Pattern\",className:b.default.header}),u.default.createElement(f.Button,{className:b.default.button,onClick:r.delete},\"Delete\")),u.default.createElement(d.default,{weeklySchedule:e,onSubmit:r.sendEdit,formName:\"officeHours\"+t,hoursIndex:t}),u.default.createElement(f.Header,{title:\"Breaks\",className:b.default.subHeader}),u.default.createElement(c.default,{weeklySchedule:e,onSubmit:r.sendEdit,formName:\"officeHours\"+t,breaksName:\"clinicBreaks\"+t,breaksIndex:t}))}));var n=[{label:\"Cancel\",onClick:this.reinitializeState,component:f.Button,props:{border:\"blue\"}},{label:\"Save\",onClick:this.changeStartDate,component:p.default,props:{color:\"blue\",form:\"advanceCreate\"}}];return u.default.createElement(v.default,{title:\"Office Hours\",bodyClass:b.default.officeHoursBody},u.default.createElement(y.default,{predicate:function(e){return e.flags.get(\"office-hours-calendar-schedule\")},render:u.default.createElement(k.default,null),fallback:u.default.createElement(\"div\",null,u.default.createElement(f.DialogBox,{actions:n,title:\"Update StartDate\",type:\"small\",active:this.state.active,onEscKeyDown:this.reinitializeState,onOverlayClick:this.reinitializeState,\"data-test-id\":\"inviteUserDialog\"},u.default.createElement(f.Form,{form:\"advanceCreate\",onSubmit:this.changeStartDate,initialValues:i,ignoreSaveButton:!0,\"data-test-id\":\"advanceCreate\"},u.default.createElement(f.Field,{required:!0,component:\"DayPicker\",name:\"startDate\",label:\"Start Date\",\"data-test-id\":\"input_startDateDayPicker\"}))),u.default.createElement(\"div\",{className:b.default.flexHeader},u.default.createElement(f.Header,{title:\"Weekly Schedule\",contentHeader:!0,className:b.default.header}),u.default.createElement(\"div\",null,u.default.createElement(f.Button,{className:b.default.button,onClick:this.createPattern,\"data-test-id\":\"button_createPatternSchedule\",secondary:!0},\"Add New Pattern\"),u.default.createElement(f.Button,{className:b.default.button,onClick:this.openModal,\"data-test-id\":\"button_changeStartDate\",secondary:!0},\"Change Start Date\"))),u.default.createElement(d.default,{weeklySchedule:i,onSubmit:e,formName:\"officeHours\",hoursIndex:0}),u.default.createElement(f.Header,{title:\"Breaks\",contentHeader:!0,className:b.default.subHeader}),u.default.createElement(c.default,{weeklySchedule:i,onSubmit:e,formName:\"officeHours\",breaksName:\"clinicBreaks\",breaksIndex:0}),a)}))}}]),O);function O(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,O);var t=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(O.__proto__||Object.getPrototypeOf(O)).call(this,e));return t.state={active:!1},t.reinitializeState=t.reinitializeState.bind(t),t.openModal=t.openModal.bind(t),t.createPattern=t.createPattern.bind(t),t.changeStartDate=t.changeStartDate.bind(t),t.sendEdit=t.sendEdit.bind(t),t.delete=t.delete.bind(t),t}w.propTypes={activeAccount:i.default.shape(S.default),weeklySchedule:i.default.shape(m.weeklyScheduleShape),updateEntityRequest:i.default.func};var C=(0,o.connect)(function(e){var t=e.entities,a=e.auth,n=t.getIn([\"accounts\",\"models\",a.get(\"accountId\")]);return n?{weeklySchedule:t.getIn([\"weeklySchedules\",\"models\",n.get(\"weeklyScheduleId\")]),activeAccount:n}:{}},function(e){return(0,s.bindActionCreators)({updateEntityRequest:h.updateEntityRequest},e)});t.default=C(w)},2845:function(e,O,C){\"use strict\";(function(r){Object.defineProperty(O,\"__esModule\",{value:!0});var i=function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var a=[],n=!0,r=!1,i=void 0;try{for(var l,u=e[Symbol.iterator]();!(n=(l=u.next()).done)&&(a.push(l.value),!t||a.length!==t);n=!0);}catch(e){r=!0,i=e}finally{try{!n&&u.return&&u.return()}finally{if(r)throw i}}return a}(e,t);throw new TypeError(\"Invalid attempt to destructure non-iterable instance\")},c=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var a=arguments[t];for(var n in a)Object.prototype.hasOwnProperty.call(a,n)&&(e[n]=a[n])}return e},e=function(e,t,a){return t&&n(e.prototype,t),a&&n(e,a),e};function n(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,\"value\"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var t=C(1),l=S(t),a=S(C(0)),u=C(15),s=C(16),o=S(C(2500)),h=S(C(370)),f=C(22),d=S(C(2501)),y=C(2846),p=C(113),m=S(C(2502));function S(e){return e&&e.__esModule?e:{default:e}}function v(e){return function(){var u=e.apply(this,arguments);return new Promise(function(i,l){return function t(e,a){try{var n=u[e](a),r=n.value}catch(e){return void l(e)}if(!n.done)return Promise.resolve(r).then(function(e){t(\"next\",e)},function(e){t(\"throw\",e)});i(r)}(\"next\")})}}function b(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}var k,D,g=(function(e,t){if(\"function\"!=typeof t&&null!==t)throw new TypeError(\"Super expression must either be null or a function, not \"+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(w,t.Component),e(w,[{key:\"componentDidMount\",value:function(){this.getSchedule()}},{key:\"onChangeMonth\",value:function(e){var t=this;this.setState({month:e,selectedDay:null,isLoading:!0,selectedDailySchedule:null},function(){return t.getSchedule(e)})}},{key:\"getModifier\",value:function(e){var i=this;return Object.keys((0,o.default)(this.state.baseSchedule.schedule,e)).map(function(e){var t=(0,f.setDateToTimezone)(e,i.props.timezone).toObject(),a=t.years,n=t.months,r=t.date;return new Date(a,n,r)})}},{key:\"getSchedule\",value:function(e){var a=this,t=0<arguments.length&&void 0!==e?e:this.state.month;return(0,y.getFinalDailyHours)({accountId:this.props.accountId,startDate:(0,f.getStartOfTheMonth)(t),endDate:(0,f.getEndOfTheMonth)(t)}).then(function(e){var t=e.data;return a.setState({baseSchedule:t},function(){return setTimeout(function(){return a.setState({isLoading:!1})},1e3)})})}},{key:\"getFeaturedDay\",value:function(e){var t=0<arguments.length&&void 0!==e?e:this.state.selectedDay;return b({},(0,f.dateFormatter)(t,this.props.timezone,\"dddd\").toLowerCase(),c({},this.state.baseSchedule.schedule[t.toISOString().split(\"T\")[0]],{isFeatured:!0}))}},{key:\"isOverride\",value:function(){return this.state.selectedDay&&this.state.selectedDailySchedule.isDailySchedule||!1}},{key:\"scheduleMap\",value:function(){var e=this.state.selectedDay&&this.state.selectedDailySchedule.isDailySchedule?this.getFeaturedDay():c({},this.state.baseSchedule.weeklySchedule,this.state.selectedDay?this.getFeaturedDay():null),t=(0,h.default)(e,[\"sunday\",\"monday\",\"tuesday\",\"wednesday\",\"thursday\",\"friday\",\"saturday\"]);return Object.entries(t).reduce(function(e,t){var a=i(t,2),n=a[0],r=a[1];return c({},e,b({},n,{breaks:r.breaks||[],chairIds:r.chairIds||[],endTime:r.endTime||null,isClosed:r.isClosed||!1,isFeatured:r.isFeatured||!1,isDailySchedule:r.isDailySchedule||!1,startTime:r.startTime||null}))},{})}},{key:\"handleDayClick\",value:function(e,t){var a=this.state.selectedDay&&this.state.selectedDay.getTime()===e.getTime()?null:e;this.setState({selectedDay:a,selectedDailySchedule:a?Object.values(this.getFeaturedDay(a))[0]:null},t)}},{key:\"handleDoubleClick\",value:function(e,t){var a=this;return function(){return a.handleDayClick(e,function(){return t((0,f.dateFormatter)(e,a.props.timezone,\"dddd\").toLowerCase())})}}},{key:\"handleCreateCustomSchedule\",value:(D=v(regeneratorRuntime.mark(function e(){var t=(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{}).date;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.createDailyHours)(t.toISOString().split(\"T\")[0]);case 3:return e.next=5,this.getSchedule();case 5:this.setState({selectedDailySchedule:this.state.selectedDay?Object.values(this.getFeaturedDay(this.state.selectedDay))[0]:null}),this.props.showAlertTimeout({alert:{body:\"Created holiday hours for the practice on \"+(0,f.dateFormatter)(t,this.props.timezone,\"dddd, MMMM Do\")},type:\"success\"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r.error(e.t0);case 12:case\"end\":return e.stop()}},e,this,[[0,9]])})),function(){return D.apply(this,arguments)})},{key:\"handleUpdateSchedule\",value:function(e,t){var a=this,n=e.isClosed,r=e.id,i=e.date,l=e.isDailySchedule,u=function(e,t){var a={};for(var n in e)0<=t.indexOf(n)||Object.prototype.hasOwnProperty.call(e,n)&&(a[n]=e[n]);return a}(e,[\"isClosed\",\"id\",\"date\",\"isDailySchedule\"]),s=(0,h.default)(u,[\"startTime\",\"endTime\",\"breaks\",\"chairIds\"]),o=(0,f.setDateToTimezone)(s.endTime,this.props.timezone).toObject(),d=(0,f.setDateToTimezone)(s.startTime,this.props.timezone).toObject();return(0,y.updateFinalDailyHours)(r,c({},s,{endTime:n?new Date(1970,1,0).toISOString():(0,f.timeWithZone)(o.hours,o.minutes,this.props.timezone).toISOString(),startTime:n?new Date(1970,1,0).toISOString():(0,f.timeWithZone)(d.hours,d.minutes,this.props.timezone).toISOString()})).then(function(){a.getSchedule(a.state.month);var e=i&&l?\"Updated holiday hours for the practice on \"+(0,f.dateFormatter)(i,a.props.timezone,\"dddd, MMMM Do\"):\"Updated default schedule for the practice\";a.props.showAlertTimeout({alert:{body:e},type:\"success\"})}).then(t)}},{key:\"handleRemoveOverrideHours\",value:(k=v(regeneratorRuntime.mark(function e(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},a=t.scheduleId,n=t.date;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,(0,y.deleteDailyHours)(a);case 3:return e.next=5,this.getSchedule();case 5:this.setState({selectedDailySchedule:this.state.selectedDay?Object.values(this.getFeaturedDay(this.state.selectedDay))[0]:null}),this.props.showAlertTimeout({alert:{body:\"Deleted holiday hours for the practice on \"+(0,f.dateFormatter)(n,this.props.timezone,\"dddd, MMMM Do\")},type:\"success\"}),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),r.error(e.t0);case 12:case\"end\":return e.stop()}},e,this,[[0,9]])})),function(){return k.apply(this,arguments)})},{key:\"render\",value:function(){var a=this,n=this.props.timezone;return l.default.createElement(\"div\",null,l.default.createElement(d.default,{baseSchedule:this.state.baseSchedule,closedDays:this.getModifier(\"isClosed\"),dailyScheduleDays:this.getModifier(\"isDailySchedule\"),handleCreateCustomSchedule:this.handleCreateCustomSchedule,handleDayClick:this.handleDayClick,handleRemoveOverrideHours:this.handleRemoveOverrideHours,handleUpdateSchedule:this.handleUpdateSchedule,isLoading:this.state.isLoading,isOverride:this.isOverride(),month:this.state.month,onChangeMonth:this.onChangeMonth,practitioner:null,renderDay:function(e,t){return(0,m.default)(e,a.handleDoubleClick(e,t),Object.values(a.getFeaturedDay(e))[0],n)},selectedDay:this.state.selectedDay,timezone:n,weeklySchedule:this.scheduleMap()}))}}]),w);function w(e){!function(e,t){if(!(e instanceof t))throw new TypeError(\"Cannot call a class as a function\")}(this,w);var t=function(e,t){if(!e)throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");return!t||\"object\"!=typeof t&&\"function\"!=typeof t?e:t}(this,(w.__proto__||Object.getPrototypeOf(w)).call(this,e));return t.state={selectedDay:null,baseSchedule:{schedule:{},isCustomSchedule:!1,dailySchedule:[],weeklySchedule:{}},selectedDailySchedule:null,isLoading:!0,month:new Date},t.getSchedule=t.getSchedule.bind(t),t.handleDayClick=t.handleDayClick.bind(t),t.handleDoubleClick=t.handleDoubleClick.bind(t),t.handleUpdateSchedule=t.handleUpdateSchedule.bind(t),t.handleCreateCustomSchedule=t.handleCreateCustomSchedule.bind(t),t.handleRemoveOverrideHours=t.handleRemoveOverrideHours.bind(t),t.onChangeMonth=t.onChangeMonth.bind(t),t.scheduleMap=t.scheduleMap.bind(t),t.getFeaturedDay=t.getFeaturedDay.bind(t),t}O.default=(0,u.connect)(function(e){var t=e.auth,a=e.entities.getIn([\"accounts\",\"models\",t.get(\"accountId\")]);return{timezone:a.get(\"timezone\"),accountId:t.get(\"accountId\"),weeklyScheduleId:a.get(\"weeklyScheduleId\")}},function(e){return(0,s.bindActionCreators)({showAlertTimeout:p.showAlertTimeout},e)})(g),g.propTypes={accountId:a.default.string.isRequired,showAlertTimeout:a.default.func.isRequired,timezone:a.default.string.isRequired}}).call(this,C(18))},2846:function(e,t,a){\"use strict\";Object.defineProperty(t,\"__esModule\",{value:!0}),t.deleteDailyHours=t.updateFinalDailyHours=t.getFinalDailyHours=t.createDailyHours=void 0;var r=a(55);t.createDailyHours=function(e){return(0,r.httpClient)().post(\"/api/dailySchedules\",{date:e,practitionerId:null,startTime:new Date(1970,1,0,8,0).toISOString(),endTime:new Date(1970,1,0,14,0).toISOString()})},t.getFinalDailyHours=function(e){var t=e.accountId,a=e.startDate,n=e.endDate;return(0,r.httpClient)().get(\"/api/accounts/\"+t+\"/finalDailySchedules\",{params:{startDate:a,endDate:n}})},t.updateFinalDailyHours=function(e,t){return(0,r.httpClient)().put(\"/api/dailySchedules/\"+e,t)},t.deleteDailyHours=function(e){return(0,r.httpClient)().delete(\"/api/dailySchedules/\"+e)}}}]);","extractedComments":[]}